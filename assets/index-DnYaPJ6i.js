(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const f of s.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&a(f)}).observe(document,{childList:!0,subtree:!0});function g(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=g(n);fetch(n.href,s)}})();const j="/gala-clicker/galaStudent.webp",F="/gala-clicker/galaTrainee.webp",B="/gala-clicker/galaJunior.webp",H="/gala-clicker/galaMiddle.webp",V="/gala-clicker/galaSenior.webp",z="/gala-clicker/galaTeamLead.webp",K="/gala-clicker/galaGoogle.webp",_="http://localhost:8080/api/users/";async function A(o){console.log("preUpdated user:",o);try{const l=await fetch(`${_}${o.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);const g=await l.json();console.log("updated user:",g)}catch(l){return console.error("Error updating user:",l),{error:"Error updating user data"}}}async function W(o){try{let l=await fetch(`${_}${o}`);if(!l.ok)throw new Error(`Request error! status: ${l.status}`);return await l.json()}catch(l){console.error("Error fetching user:",l)}}function Q(){const o=document.querySelectorAll("nav ul li a"),l=document.querySelectorAll(".section");o.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const r=t.target.getAttribute("data-section");l.forEach(c=>{c.id===r?c.classList.add("active"):c.classList.remove("active")})})}),document.querySelectorAll("img").forEach(e=>{e.addEventListener("contextmenu",t=>t.preventDefault()),e.setAttribute("draggable","false")});const a=document.querySelector("#circle"),n=document.querySelector("#score"),s=document.querySelector("#daily-score"),f=document.querySelector("#monthly-score"),D=document.querySelector("#progress-fill"),N=document.querySelector("#clicks-left"),P=document.querySelector("#available-lines");let d=Number(localStorage.getItem("availableLines"))||100,S=null,b=null;const p=[{id:1,name:"Student",numberOfCodeLines:0,imgUrl:j,xlevel:1,maxLines:100},{id:2,name:"Trainee",numberOfCodeLines:1e4,imgUrl:F,xlevel:1,maxLines:100},{id:3,name:"Junior",numberOfCodeLines:1e5,imgUrl:B,xlevel:5,maxLines:200},{id:4,name:"Middle",numberOfCodeLines:1e6,imgUrl:H,xlevel:10,maxLines:400},{id:5,name:"Senior",numberOfCodeLines:1e7,imgUrl:V,xlevel:15,maxLines:600},{id:6,name:"Team Lead",numberOfCodeLines:1e8,imgUrl:z,xlevel:25,maxLines:800},{id:7,name:"Google",numberOfCodeLines:1e9,imgUrl:K,xlevel:50,maxLines:999}];function R(e){X(),Y(),x(i()),U(w()),$(C()),O(),E(),T(),h(),d<u(i()).maxLines&&(S=setInterval(M,1e3)),q(v)}function x(e){localStorage.setItem("score",e),n.textContent=e}function U(e){localStorage.setItem("dailyScore",e),s.textContent=e}function $(e){localStorage.setItem("monthlyScore",e),f.textContent=e}function i(){return Number(localStorage&&localStorage.getItem("score"))||0}function w(){return Number(localStorage.getItem("dailyScore"))||0}function C(){return Number(localStorage.getItem("monthlyScore"))||0}function X(){const e=localStorage.getItem("lastUpdated"),t=new Date().toISOString().split("T")[0];e!==t&&(localStorage.setItem("dailyScore",0),localStorage.setItem("lastUpdated",t))}function Y(){const e=localStorage.getItem("lastUpdatedMonthly"),t=new Date().toISOString().split("T")[0].slice(0,7);e!==t&&(localStorage.setItem("monthlyScore",0),localStorage.setItem("lastUpdatedMonthly",t))}function G(){if(d>0){const e=i(),t=u(e),r=i()+t.xlevel,c=w()+t.xlevel,y=C()+t.xlevel;d-=1,localStorage.setItem("availableLines",String(d)),x(r),U(c),$(y),O(),E(),T(),h();const L={id:localStorage.getItem("userId"),first_name:localStorage.getItem("first_name"),last_name:localStorage.getItem("last_name"),username:localStorage.getItem("username"),score:r,dailyScore:localStorage.getItem("dailyScore"),monthlyScore:localStorage.getItem("monthlyScore"),lastUpdated:localStorage.getItem("lastUpdated"),lastUpdatedMonthly:localStorage.getItem("lastUpdatedMonthly"),availableLines:d};q(L),A(L),clearTimeout(b),clearInterval(S),b=setTimeout(()=>{S=setInterval(M,1e3)},5e3)}else{a.classList.add("grayscale");return}}function O(){const e=i(),t=k(e),r=u(e),c=(e-r.numberOfCodeLines)/(t.numberOfCodeLines-r.numberOfCodeLines)*100;D.style.width=`${c}%`}function T(){const e=i(),t=k(e),r=u(e),c=Math.ceil((t.numberOfCodeLines-e)/r.xlevel);N.textContent=`Lines left level ${t.name}: ${c}`}function E(){const e=i(),t=u(e);a.setAttribute("src",`${t.imgUrl}`)}function h(){const e=i(),t=u(e);P.textContent=`${d} / ${t.maxLines}`}function M(){const e=i(),t=u(e);d<t.maxLines?(d+=1,localStorage.setItem("availableLines",d),h(),A(v),d>0&&a.classList.remove("grayscale")):clearInterval(S)}function u(e){return p.slice().reverse().find(t=>e>=t.numberOfCodeLines)||p[0]}function k(e){return p.find(t=>e<t.numberOfCodeLines)||p[p.length-1]}function q(e){const t=document.querySelector(".user__info"),r=i(),c=u(r);t.innerHTML=`
            <p>Total Clicks: ${r}</p>
            <p>Current Level: ${c.name}</p>
            <p>First Name: ${e.first_name}</p>
            <p>Last Name: ${e.last_name}</p>
        `}a.addEventListener("click",e=>{const t=a.getBoundingClientRect(),r=e.clientX-t.left-t.width/2,c=e.clientY-t.top-t.height/2,y=40,L=c/t.height*y,J=r/t.width*-y;a.style.setProperty("--tiltX",`${L}deg`),a.style.setProperty("--tiltY",`${J}deg`),setTimeout(()=>{a.style.setProperty("--tiltX","0deg"),a.style.setProperty("--tiltY","0deg")},200);const m=document.createElement("div");m.classList.add("plusone"),m.textContent=`+${u(i()).xlevel}`,m.style.left=`${e.clientX-t.left}px`,m.style.top=`${e.clientY-t.top}px`,a.parentElement.appendChild(m),G(),setTimeout(()=>{m.remove()},2e3)}),R()}const I=window.Telegram.WebApp,v=I.initDataUnsafe.user;v?(W(v.id).then(o=>{o&&(console.log("User data:",o),localStorage.setItem("userId",o.id),localStorage.setItem("username",o.username),localStorage.setItem("first_name",o.first_name),localStorage.setItem("last_name",o.last_name),localStorage.setItem("score",o.score),localStorage.setItem("dailyScore",o.dailyScore),localStorage.setItem("monthlyScore",o.monthlyScore),localStorage.setItem("lastUpdated",o.lastUpdated),localStorage.setItem("lastUpdatedMonthly",o.lastUpdatedMonthly),localStorage.setItem("availableLines",String(o.availableLines)),Q())}),I.expand(),I.ready()):console.error("User data not available");
