(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const y of c.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&l(y)}).observe(document,{childList:!0,subtree:!0});function d(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerPolicy&&(c.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?c.credentials="include":r.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function l(r){if(r.ep)return;r.ep=!0;const c=d(r);fetch(r.href,c)}})();var a=[];for(var U=0;U<256;++U)a.push((U+256).toString(16).slice(1));function K(e,o=0){return(a[e[o+0]]+a[e[o+1]]+a[e[o+2]]+a[e[o+3]]+"-"+a[e[o+4]]+a[e[o+5]]+"-"+a[e[o+6]]+a[e[o+7]]+"-"+a[e[o+8]]+a[e[o+9]]+"-"+a[e[o+10]]+a[e[o+11]]+a[e[o+12]]+a[e[o+13]]+a[e[o+14]]+a[e[o+15]]).toLowerCase()}var h,W=new Uint8Array(16);function Q(){if(!h&&(h=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!h))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return h(W)}var Z=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const q={randomUUID:Z};function ee(e,o,d){if(q.randomUUID&&!o&&!e)return q.randomUUID();e=e||{};var l=e.random||(e.rng||Q)();return l[6]=l[6]&15|64,l[8]=l[8]&63|128,K(l)}const te="/gala-clicker/galaStudent.webp",oe="/gala-clicker/galaTrainee.webp",ne="/gala-clicker/galaJunior.webp",le="/gala-clicker/galaMiddle.webp",re="/gala-clicker/galaSenior.webp",ae="/gala-clicker/galaTeamLead.webp",se="/gala-clicker/galaGoogle.webp",V="http://localhost:8080/api/users/";async function N(e){console.log("preUpdated user:",e);try{const o=await fetch(`${V}${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){return console.error("Error updating user:",o),{error:"Error updating user data"}}}async function ce(e){try{let o=await fetch(`${V}${e}`);if(console.log("response1",o),!o.ok)throw new Error(`Request error! status: ${o.status}`);let d=await o.json();return console.log("User fetched:",d),d}catch(o){console.error("Error fetching user:",o)}}function ie(e){const o=e.getFullYear(),d=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getDate()).padStart(2,"0");return`${o}-${d}-${l}`}function P(e){const[o,d,l]=e.split("-").map(Number);return new Date(o,d-1,l)}function R(){const e=document.querySelectorAll("nav ul li a"),o=document.querySelectorAll(".section");e.forEach(t=>{t.addEventListener("click",n=>{n.preventDefault();const s=n.target.getAttribute("data-section");o.forEach(i=>{i.id===s?i.classList.add("active"):i.classList.remove("active")})})}),document.querySelectorAll("img").forEach(t=>{t.addEventListener("contextmenu",n=>n.preventDefault()),t.setAttribute("draggable","false")});const l=document.querySelector("#circle"),r=document.querySelector("#score"),c=document.querySelector("#daily-score"),y=document.querySelector("#monthly-score"),X=document.querySelector("#progress-fill"),j=document.querySelector("#clicks-left"),F=document.querySelector("#available-lines");let m=localStorage.getItem("availableLines"),v=null,w=null;const S=[{id:1,name:"Student",numberOfCodeLines:0,imgUrl:te,xlevel:1,maxLines:100},{id:2,name:"Trainee",numberOfCodeLines:1e4,imgUrl:oe,xlevel:1,maxLines:100},{id:3,name:"Junior",numberOfCodeLines:1e5,imgUrl:ne,xlevel:5,maxLines:200},{id:4,name:"Middle",numberOfCodeLines:1e6,imgUrl:le,xlevel:10,maxLines:400},{id:5,name:"Senior",numberOfCodeLines:1e7,imgUrl:re,xlevel:15,maxLines:600},{id:6,name:"Team Lead",numberOfCodeLines:1e8,imgUrl:ae,xlevel:25,maxLines:800},{id:7,name:"Google",numberOfCodeLines:1e9,imgUrl:se,xlevel:50,maxLines:999}];function G(t){J(),H(),$(u()),C(T()),D(O()),M(),Y(),E(),b(),m<g(u()).maxLines&&(v=setInterval(_,1e3)),A(I)}function $(t){localStorage.setItem("score",t),r.textContent=t}function C(t){localStorage.setItem("dailyScore",t),c.textContent=t}function D(t){localStorage.setItem("monthlyScore",t),y.textContent=t}function u(){return Number(localStorage&&localStorage.getItem("score"))||0}function T(){return Number(localStorage.getItem("dailyScore"))||0}function O(){return Number(localStorage.getItem("monthlyScore"))||0}function J(){const t=localStorage.getItem("lastUpdated"),n=ie(new Date);t!==n&&(localStorage.setItem("dailyScore",0),localStorage.setItem("lastUpdated",n))}function H(){const t=localStorage.getItem("lastUpdatedMonthly").slice(0,7),n=new Date().toISOString().split("T")[0];t!==n.slice(0,7)&&(localStorage.setItem("monthlyScore",0),localStorage.setItem("lastUpdatedMonthly",n))}function B(){if(m>0){const t=u(),n=g(t),s=u()+n.xlevel,i=T()+n.xlevel,L=O()+n.xlevel;m-=1,localStorage.setItem("availableLines",m),$(s),C(i),D(L),M(),Y(),E(),b();const f={id:localStorage.getItem("userId"),first_name:localStorage.getItem("first_name"),last_name:localStorage.getItem("last_name"),username:localStorage.getItem("username"),score:s,dailyScore:localStorage.getItem("dailyScore"),monthlyScore:localStorage.getItem("monthlyScore"),lastUpdated:P(localStorage.getItem("lastUpdated")),lastUpdatedMonthly:P(localStorage.getItem("lastUpdatedMonthly")),availableLines:m};console.log("Updated user:",f),A(f),N(f),clearTimeout(w),clearInterval(v),w=setTimeout(()=>{v=setInterval(_,1e3)},5e3)}else{l.classList.add("grayscale");return}}function M(){const t=u(),n=k(t),s=g(t),i=(t-s.numberOfCodeLines)/(n.numberOfCodeLines-s.numberOfCodeLines)*100;X.style.width=`${i}%`}function E(){const t=u(),n=k(t),s=g(t),i=Math.ceil((n.numberOfCodeLines-t)/s.xlevel);j.textContent=`Lines left level ${n.name}: ${i}`}function Y(){const t=u(),n=g(t);l.setAttribute("src",`${n.imgUrl}`)}function b(){const t=u(),n=g(t);F.textContent=`${m} / ${n.maxLines}`}function _(){const t=u(),n=g(t);m<n.maxLines?(m+=1,localStorage.setItem("availableLines",m),b(),N(I),m>0&&l.classList.remove("grayscale")):clearInterval(v)}function g(t){return S.slice().reverse().find(n=>t>=n.numberOfCodeLines)||S[0]}function k(t){return S.find(n=>t<n.numberOfCodeLines)||S[S.length-1]}function A(t){const n=document.querySelector(".user__info"),s=u(),i=g(s);n.innerHTML=`
            <p>Total Clicks: ${s}</p>
            <p>Current Level: ${i.name}</p>
            <p>First Name: ${t.first_name}</p>
            <p>Last Name: ${t.last_name}</p>
        `}l.addEventListener("click",t=>{const n=l.getBoundingClientRect(),s=t.clientX-n.left-n.width/2,i=t.clientY-n.top-n.height/2,L=40,f=i/n.height*L,z=s/n.width*-L;l.style.setProperty("--tiltX",`${f}deg`),l.style.setProperty("--tiltY",`${z}deg`),setTimeout(()=>{l.style.setProperty("--tiltX","0deg"),l.style.setProperty("--tiltY","0deg")},200);const p=document.createElement("div");p.classList.add("plusone"),p.textContent=`+${g(u()).xlevel}`,p.style.left=`${t.clientX-n.left}px`,p.style.top=`${t.clientY-n.top}px`,l.parentElement.appendChild(p),B(),setTimeout(()=>{p.remove()},2e3)}),G()}const x=window.Telegram.WebApp,I=x.initDataUnsafe.user;I?(ce(I.id).then(e=>{e&&(console.log("User data:",e),localStorage.setItem("userId",e.id),localStorage.setItem("username",e.username),localStorage.setItem("first_name",e.first_name),localStorage.setItem("last_name",e.last_name),localStorage.setItem("score",e.score),localStorage.setItem("dailyScore",e.dailyScore),localStorage.setItem("monthlyScore",e.monthlyScore),localStorage.setItem("lastUpdated",e.lastUpdated),localStorage.setItem("lastUpdatedMonthly",e.lastUpdatedMonthly),localStorage.setItem("availableLines",e.availableLines),R())}),x.expand(),x.ready()):R({id:ee(),first_name:"Test",last_name:"Testovich",username:"Testolio",score:0,dailyScore:0,monthlyScore:0,lastUpdated:new Date().toISOString().slice("T")[0],lastUpdatedMonthly:new Date().toISOString().slice(0,7),availableLines:0});
