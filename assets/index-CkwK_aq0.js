(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))y(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const g of n.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&y(g)}).observe(document,{childList:!0,subtree:!0});function d(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function y(o){if(o.ep)return;o.ep=!0;const n=d(o);fetch(o.href,n)}})();const z="/gala-clicker/galaStudent.webp",B="/gala-clicker/galaTrainee.webp",V="/gala-clicker/galaJunior.webp",W="/gala-clicker/galaMiddle.webp",H="/gala-clicker/galaSenior.webp",K="/gala-clicker/galaTeamLead.webp",Q="/gala-clicker/galaGoogle.webp",q="http://localhost:8080/api/users";async function Z(a){return(await fetch(`${q}/users/${a.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json()}async function ee(a){return(await fetch(`${q}/users/${a}`)).json()}function k(a){console.log("Initializing app with user:",a);const c=document.querySelectorAll("nav ul li a"),d=document.querySelectorAll(".section");c.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const l=t.target.getAttribute("data-section");d.forEach(r=>{r.id===l?r.classList.add("active"):r.classList.remove("active")})})}),document.querySelectorAll("img").forEach(e=>{e.addEventListener("contextmenu",t=>t.preventDefault()),e.setAttribute("draggable","false")});const o=document.querySelector("#circle"),n=document.querySelector("#score"),g=document.querySelector("#daily-score"),D=document.querySelector("#monthly-score"),N=document.querySelector("#total-score"),P=document.querySelector("#progress-fill"),R=document.querySelector("#clicks-left"),X=document.querySelector("#available-lines");let i=localStorage.getItem("availableLines")?Number(localStorage.getItem("availableLines")):100,p=null,b=null;const f=[{id:1,name:"Student",numberOfCodeLines:0,imgUrl:z,xlevel:1,maxLines:100},{id:2,name:"Trainee",numberOfCodeLines:1e4,imgUrl:B,xlevel:1,maxLines:100},{id:3,name:"Junior",numberOfCodeLines:1e5,imgUrl:V,xlevel:5,maxLines:200},{id:4,name:"Middle",numberOfCodeLines:1e6,imgUrl:W,xlevel:10,maxLines:400},{id:5,name:"Senior",numberOfCodeLines:1e7,imgUrl:H,xlevel:15,maxLines:600},{id:6,name:"Team Lead",numberOfCodeLines:1e8,imgUrl:K,xlevel:25,maxLines:800},{id:7,name:"Google",numberOfCodeLines:1e9,imgUrl:Q,xlevel:50,maxLines:999}];function Y(e){_(),G(),h(s()),x($()),I(w()),C(O()),T(),A(),U(),L(),i<u(s()).maxLines&&(p=setInterval(E,1e3)),j(a)}function h(e){localStorage.setItem("score",e),n.textContent=e}function x(e){localStorage.setItem("dailyScore",e),g.textContent=e}function I(e){localStorage.setItem("monthlyScore",e),D.textContent=e}function C(e){localStorage.setItem("totalScore",e),N.textContent=e}function s(){return Number(localStorage&&localStorage.getItem("score"))||0}function $(){return Number(localStorage.getItem("dailyScore"))||0}function w(){return Number(localStorage.getItem("monthlyScore"))||0}function O(){return Number(localStorage.getItem("totalScore"))||0}function _(){const e=localStorage.getItem("lastUpdated"),t=new Date().toISOString().split("T")[0];e!==t&&(localStorage.setItem("dailyScore",0),localStorage.setItem("lastUpdated",t))}function G(){const e=localStorage.getItem("lastUpdatedMonthly"),t=new Date().toISOString().slice(0,7);e!==t&&(localStorage.setItem("monthlyScore",0),localStorage.setItem("lastUpdatedMonthly",t))}function J(){if(i>0){const e=s(),t=u(e),l=s()+t.xlevel,r=$()+t.xlevel,S=w()+t.xlevel,v=O()+t.xlevel;i-=1,localStorage.setItem("availableLines",i),h(l),x(r),I(S),C(v),T(),A(),U(),L(),clearTimeout(b),clearInterval(p),b=setTimeout(()=>{p=setInterval(E,1e3)},5e3)}else{o.classList.add("grayscale");return}}function T(){const e=s(),t=M(e),l=u(e),r=(e-l.numberOfCodeLines)/(t.numberOfCodeLines-l.numberOfCodeLines)*100;P.style.width=`${r}%`}function U(){const e=s(),t=M(e),l=u(e),r=Math.ceil((t.numberOfCodeLines-e)/l.xlevel);R.textContent=`Lines left level ${t.name}: ${r}`}function A(){const e=s(),t=u(e);o.setAttribute("src",`${t.imgUrl}`)}function L(){const e=s(),t=u(e);X.textContent=`${i} / ${t.maxLines}`}function E(){const e=s(),t=u(e);i<t.maxLines?(i+=1,localStorage.setItem("availableLines",i),L(),i>0&&o.classList.remove("grayscale")):clearInterval(p)}function u(e){return f.slice().reverse().find(t=>e>=t.numberOfCodeLines)||f[0]}function M(e){return f.find(t=>e<t.numberOfCodeLines)||f[f.length-1]}function j(e){const t=document.querySelector(".user__info"),l=s(),r=u(l);t.innerHTML=`
            <p>Total Clicks: ${l}</p>
            <p>Current Level: ${r.name}</p>
            <p>First Name: ${e.first_name}</p>
            <p>Last Name: ${e.last_name}</p>
        `}o.addEventListener("click",e=>{const t=o.getBoundingClientRect(),l=e.clientX-t.left-t.width/2,r=e.clientY-t.top-t.height/2,S=40,v=r/t.height*S,F=l/t.width*-S;o.style.setProperty("--tiltX",`${v}deg`),o.style.setProperty("--tiltY",`${F}deg`),setTimeout(()=>{o.style.setProperty("--tiltX","0deg"),o.style.setProperty("--tiltY","0deg")},200);const m=document.createElement("div");m.classList.add("plusone"),m.textContent=`+${u(s()).xlevel}`,m.style.left=`${e.clientX-t.left}px`,m.style.top=`${e.clientY-t.top}px`,o.parentElement.appendChild(m),J(),setTimeout(()=>{m.remove()},2e3)}),Y()}if(window.Telegram&&window.Telegram.WebApp){const a=window.Telegram.WebApp,c=a.initDataUnsafe.user;c&&ee(c.id).then(d=>{d?(localStorage.setItem("score",d.totalClicks),localStorage.setItem("level",d.level),localStorage.setItem("availableLines",100)):Z(c),k(c)}),a.expand(),a.ready()}else k();
