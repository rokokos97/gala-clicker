(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const y of c.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&l(y)}).observe(document,{childList:!0,subtree:!0});function g(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerPolicy&&(c.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?c.credentials="include":r.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function l(r){if(r.ep)return;r.ep=!0;const c=g(r);fetch(r.href,c)}})();var a=[];for(var U=0;U<256;++U)a.push((U+256).toString(16).slice(1));function z(t,n=0){return(a[t[n+0]]+a[t[n+1]]+a[t[n+2]]+a[t[n+3]]+"-"+a[t[n+4]]+a[t[n+5]]+"-"+a[t[n+6]]+a[t[n+7]]+"-"+a[t[n+8]]+a[t[n+9]]+"-"+a[t[n+10]]+a[t[n+11]]+a[t[n+12]]+a[t[n+13]]+a[t[n+14]]+a[t[n+15]]).toLowerCase()}var h,K=new Uint8Array(16);function W(){if(!h&&(h=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!h))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return h(K)}var Q=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const P={randomUUID:Q};function Z(t,n,g){if(P.randomUUID&&!n&&!t)return P.randomUUID();t=t||{};var l=t.random||(t.rng||W)();return l[6]=l[6]&15|64,l[8]=l[8]&63|128,z(l)}const ee="/gala-clicker/galaStudent.webp",te="/gala-clicker/galaTrainee.webp",oe="/gala-clicker/galaJunior.webp",ne="/gala-clicker/galaMiddle.webp",le="/gala-clicker/galaSenior.webp",re="/gala-clicker/galaTeamLead.webp",ae="/gala-clicker/galaGoogle.webp",Y="http://localhost:8080/api/users/";async function R(t){console.log("preUpdated user:",t);try{const n=await fetch(`${Y}${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return await n.json()}catch(n){return console.error("Error updating user:",n),{error:"Error updating user data"}}}async function se(t){try{let n=await fetch(`${Y}${t}`);if(console.log("response1",n),!n.ok)throw new Error(`Request error! status: ${n.status}`);let g=await n.json();return console.log("User fetched:",g),g}catch(n){console.error("Error fetching user:",n)}}function N(){const t=document.querySelectorAll("nav ul li a"),n=document.querySelectorAll(".section");t.forEach(e=>{e.addEventListener("click",o=>{o.preventDefault();const s=o.target.getAttribute("data-section");n.forEach(i=>{i.id===s?i.classList.add("active"):i.classList.remove("active")})})}),document.querySelectorAll("img").forEach(e=>{e.addEventListener("contextmenu",o=>o.preventDefault()),e.setAttribute("draggable","false")});const l=document.querySelector("#circle"),r=document.querySelector("#score"),c=document.querySelector("#daily-score"),y=document.querySelector("#monthly-score"),F=document.querySelector("#progress-fill"),V=document.querySelector("#clicks-left"),X=document.querySelector("#available-lines");let u=localStorage.getItem("availableLines"),v=null,w=null;const f=[{id:1,name:"Student",numberOfCodeLines:0,imgUrl:ee,xlevel:1,maxLines:100},{id:2,name:"Trainee",numberOfCodeLines:1e4,imgUrl:te,xlevel:1,maxLines:100},{id:3,name:"Junior",numberOfCodeLines:1e5,imgUrl:oe,xlevel:5,maxLines:200},{id:4,name:"Middle",numberOfCodeLines:1e6,imgUrl:ne,xlevel:10,maxLines:400},{id:5,name:"Senior",numberOfCodeLines:1e7,imgUrl:le,xlevel:15,maxLines:600},{id:6,name:"Team Lead",numberOfCodeLines:1e8,imgUrl:re,xlevel:25,maxLines:800},{id:7,name:"Google",numberOfCodeLines:1e9,imgUrl:ae,xlevel:50,maxLines:999}];function j(e){G(),J(),$(d()),C(O()),M(T()),D(),_(),E(),b(),u<m(d()).maxLines&&(v=setInterval(k,1e3)),q(I)}function $(e){localStorage.setItem("score",e),r.textContent=e}function C(e){localStorage.setItem("dailyScore",e),c.textContent=e}function M(e){localStorage.setItem("monthlyScore",e),y.textContent=e}function d(){return Number(localStorage&&localStorage.getItem("score"))||0}function O(){return Number(localStorage.getItem("dailyScore"))||0}function T(){return Number(localStorage.getItem("monthlyScore"))||0}function G(){const e=localStorage.getItem("lastUpdated"),o=new Date;e.getFullYear()===o.getFullYear()&&e.getMonth()===o.getMonth()&&e.getDate()||(localStorage.setItem("dailyScore",0),localStorage.setItem("lastUpdated",o))}function J(){const e=localStorage.getItem("lastUpdatedMonthly"),o=new Date;e.getFullYear()===o.getFullYear()&&e.getMonth()===o.getMonth()||(localStorage.setItem("monthlyScore",0),localStorage.setItem("lastUpdatedMonthly",o))}function H(){if(u>0){const e=d(),o=m(e),s=d()+o.xlevel,i=O()+o.xlevel,L=T()+o.xlevel;u-=1,localStorage.setItem("availableLines",u),$(s),C(i),M(L),D(),_(),E(),b();const S={id:localStorage.getItem("userId"),first_name:localStorage.getItem("first_name"),last_name:localStorage.getItem("last_name"),username:localStorage.getItem("username"),score:s,dailyScore:localStorage.getItem("dailyScore"),monthlyScore:localStorage.getItem("monthlyScore"),lastUpdated:localStorage.getItem("lastUpdated"),lastUpdatedMonthly:localStorage.getItem("lastUpdatedMonthly"),availableLines:localStorage.getItem("availableLines")};console.log("Updated user:",S),q(S),R(S),clearTimeout(w),clearInterval(v),w=setTimeout(()=>{v=setInterval(k,1e3)},5e3)}else{l.classList.add("grayscale");return}}function D(){const e=d(),o=A(e),s=m(e),i=(e-s.numberOfCodeLines)/(o.numberOfCodeLines-s.numberOfCodeLines)*100;F.style.width=`${i}%`}function E(){const e=d(),o=A(e),s=m(e),i=Math.ceil((o.numberOfCodeLines-e)/s.xlevel);V.textContent=`Lines left level ${o.name}: ${i}`}function _(){const e=d(),o=m(e);l.setAttribute("src",`${o.imgUrl}`)}function b(){const e=d(),o=m(e);X.textContent=`${u} / ${o.maxLines}`}function k(){const e=d(),o=m(e);u<o.maxLines?(u+=1,localStorage.setItem("availableLines",u),b(),R(I),u>0&&l.classList.remove("grayscale")):clearInterval(v)}function m(e){return f.slice().reverse().find(o=>e>=o.numberOfCodeLines)||f[0]}function A(e){return f.find(o=>e<o.numberOfCodeLines)||f[f.length-1]}function q(e){const o=document.querySelector(".user__info"),s=d(),i=m(s);o.innerHTML=`
            <p>Total Clicks: ${s}</p>
            <p>Current Level: ${i.name}</p>
            <p>First Name: ${e.first_name}</p>
            <p>Last Name: ${e.last_name}</p>
        `}l.addEventListener("click",e=>{const o=l.getBoundingClientRect(),s=e.clientX-o.left-o.width/2,i=e.clientY-o.top-o.height/2,L=40,S=i/o.height*L,B=s/o.width*-L;l.style.setProperty("--tiltX",`${S}deg`),l.style.setProperty("--tiltY",`${B}deg`),setTimeout(()=>{l.style.setProperty("--tiltX","0deg"),l.style.setProperty("--tiltY","0deg")},200);const p=document.createElement("div");p.classList.add("plusone"),p.textContent=`+${m(d()).xlevel}`,p.style.left=`${e.clientX-o.left}px`,p.style.top=`${e.clientY-o.top}px`,l.parentElement.appendChild(p),H(),setTimeout(()=>{p.remove()},2e3)}),j()}const x=window.Telegram.WebApp,I=x.initDataUnsafe.user;I?(se(I.id).then(t=>{t&&(localStorage.setItem("userId",t.id),localStorage.setItem("username",t.username),localStorage.setItem("first_name",t.first_name),localStorage.setItem("last_name",t.last_name),localStorage.setItem("score",t.score),localStorage.setItem("dailyScore",t.dailyScore),localStorage.setItem("monthlyScore",t.monthlyScore),localStorage.setItem("lastUpdated",t.lastUpdated),localStorage.setItem("lastUpdatedMonthly",t.lastUpdatedMonthly),localStorage.setItem("availableLines",t.availableLines),N())}),x.expand(),x.ready()):N({id:Z(),first_name:"Test",last_name:"Testovich",username:"Testolio",score:0,dailyScore:0,monthlyScore:0,lastUpdated:new Date,lastUpdatedMonthly:new Date().toISOString().slice(0,7),availableLines:0});
