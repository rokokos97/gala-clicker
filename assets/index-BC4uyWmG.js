(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))y(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const g of l.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&y(g)}).observe(document,{childList:!0,subtree:!0});function m(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function y(r){if(r.ep)return;r.ep=!0;const l=m(r);fetch(r.href,l)}})();const F="/gala-clicker/galaStudent.webp",H="/gala-clicker/galaTrainee.webp",z="/gala-clicker/galaJunior.webp",B="/gala-clicker/galaMiddle.webp",V="/gala-clicker/galaSenior.webp",K="/gala-clicker/galaTeamLead.webp",W="/gala-clicker/galaGoogle.webp",A="http://localhost:8080/api/users/";async function Q(c){try{const o=await fetch(`${A}${c.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){return console.error("Error updating user:",o),{error:"Error updating user data"}}}async function Z(c){try{const o=await fetch(`${A}${c}`);if(!o.ok){if(o.status===404)return null;throw new Error(`HTTP error! status: ${o.status}`)}return await o.json()}catch(o){return console.error("Error fetching user:",o),{error:"Error fetching user data"}}}function _(c){const o=document.querySelectorAll("nav ul li a"),m=document.querySelectorAll(".section");o.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const n=t.target.getAttribute("data-section");m.forEach(a=>{a.id===n?a.classList.add("active"):a.classList.remove("active")})})}),document.querySelectorAll("img").forEach(e=>{e.addEventListener("contextmenu",t=>t.preventDefault()),e.setAttribute("draggable","false")});const r=document.querySelector("#circle"),l=document.querySelector("#score"),g=document.querySelector("#daily-score"),q=document.querySelector("#monthly-score"),D=document.querySelector("#progress-fill"),P=document.querySelector("#clicks-left"),N=document.querySelector("#available-lines");let i=localStorage.getItem("availableLines")?Number(localStorage.getItem("availableLines")):100,S=null,b=null;const f=[{id:1,name:"Student",numberOfCodeLines:0,imgUrl:F,xlevel:1,maxLines:100},{id:2,name:"Trainee",numberOfCodeLines:1e4,imgUrl:H,xlevel:1,maxLines:100},{id:3,name:"Junior",numberOfCodeLines:1e5,imgUrl:z,xlevel:5,maxLines:200},{id:4,name:"Middle",numberOfCodeLines:1e6,imgUrl:B,xlevel:10,maxLines:400},{id:5,name:"Senior",numberOfCodeLines:1e7,imgUrl:V,xlevel:15,maxLines:600},{id:6,name:"Team Lead",numberOfCodeLines:1e8,imgUrl:K,xlevel:25,maxLines:800},{id:7,name:"Google",numberOfCodeLines:1e9,imgUrl:W,xlevel:50,maxLines:999}];function R(e){X(),Y(),I(s()),x(w()),$(C()),O(),T(),U(),L(),i<u(s()).maxLines&&(S=setInterval(E,1e3)),J(c)}function I(e){localStorage.setItem("score",e),l.textContent=e}function x(e){localStorage.setItem("dailyScore",e),g.textContent=e}function $(e){localStorage.setItem("monthlyScore",e),q.textContent=e}function s(){return Number(localStorage&&localStorage.getItem("score"))||0}function w(){return Number(localStorage.getItem("dailyScore"))||0}function C(){return Number(localStorage.getItem("monthlyScore"))||0}function X(){const e=localStorage.getItem("lastUpdated"),t=new Date().toISOString().split("T")[0];e!==t&&(localStorage.setItem("dailyScore",0),localStorage.setItem("lastUpdated",t))}function Y(){const e=localStorage.getItem("lastUpdatedMonthly"),t=new Date().toISOString().slice(0,7);e!==t&&(localStorage.setItem("monthlyScore",0),localStorage.setItem("lastUpdatedMonthly",t))}function G(){if(i>0){const e=s(),t=u(e),n=s()+t.xlevel,a=w()+t.xlevel,p=C()+t.xlevel;i-=1,localStorage.setItem("availableLines",i),I(n),x(a),$(p),O(),T(),U(),L();const v={id:localStorage.getItem("userId"),first_name:localStorage.getItem("first_name"),last_name:localStorage.getItem("last_name"),username:localStorage.getItem("username"),score:n,level:t.id,availableLines:i};Q(v),clearTimeout(b),clearInterval(S),b=setTimeout(()=>{S=setInterval(E,1e3)},5e3)}else{r.classList.add("grayscale");return}}function O(){const e=s(),t=k(e),n=u(e),a=(e-n.numberOfCodeLines)/(t.numberOfCodeLines-n.numberOfCodeLines)*100;D.style.width=`${a}%`}function U(){const e=s(),t=k(e),n=u(e),a=Math.ceil((t.numberOfCodeLines-e)/n.xlevel);P.textContent=`Lines left level ${t.name}: ${a}`}function T(){const e=s(),t=u(e);r.setAttribute("src",`${t.imgUrl}`)}function L(){const e=s(),t=u(e);N.textContent=`${i} / ${t.maxLines}`}function E(){const e=s(),t=u(e);i<t.maxLines?(i+=1,localStorage.setItem("availableLines",i),L(),i>0&&r.classList.remove("grayscale")):clearInterval(S)}function u(e){return f.slice().reverse().find(t=>e>=t.numberOfCodeLines)||f[0]}function k(e){return f.find(t=>e<t.numberOfCodeLines)||f[f.length-1]}function J(e){const t=document.querySelector(".user__info"),n=s(),a=u(n);t.innerHTML=`
            <p>Total Clicks: ${n}</p>
            <p>Current Level: ${a.name}</p>
            <p>First Name: ${e.first_name}</p>
            <p>Last Name: ${e.last_name}</p>
        `}r.addEventListener("click",e=>{const t=r.getBoundingClientRect(),n=e.clientX-t.left-t.width/2,a=e.clientY-t.top-t.height/2,p=40,v=a/t.height*p,j=n/t.width*-p;r.style.setProperty("--tiltX",`${v}deg`),r.style.setProperty("--tiltY",`${j}deg`),setTimeout(()=>{r.style.setProperty("--tiltX","0deg"),r.style.setProperty("--tiltY","0deg")},200);const d=document.createElement("div");d.classList.add("plusone"),d.textContent=`+${u(s()).xlevel}`,d.style.left=`${e.clientX-t.left}px`,d.style.top=`${e.clientY-t.top}px`,r.parentElement.appendChild(d),G(),setTimeout(()=>{d.remove()},2e3)}),R()}const h=window.Telegram.WebApp,M=h.initDataUnsafe.user;async function ee(c){try{const o=await Z(c.id);o&&(localStorage.setItem("userId",o.id),localStorage.setItem("score",o.score),localStorage.setItem("dailyScore",o.dailyScore),localStorage.setItem("monthlyScore",o.monthlyScore),localStorage.setItem("level",o.level),localStorage.setItem("first_name",o.first_name),localStorage.setItem("last_name",o.last_name),localStorage.setItem("availableLines",o.availableLines),localStorage.setItem("username",o.username)),_(c)}catch(o){alert(o)}}M?(ee(M),h.expand(),h.ready()):_();
