(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))u(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const p of s.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&u(p)}).observe(document,{childList:!0,subtree:!0});function g(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function u(n){if(n.ep)return;n.ep=!0;const s=g(n);fetch(n.href,s)}})();var r=[];for(var U=0;U<256;++U)r.push((U+256).toString(16).slice(1));function K(t,e=0){return(r[t[e+0]]+r[t[e+1]]+r[t[e+2]]+r[t[e+3]]+"-"+r[t[e+4]]+r[t[e+5]]+"-"+r[t[e+6]]+r[t[e+7]]+"-"+r[t[e+8]]+r[t[e+9]]+"-"+r[t[e+10]]+r[t[e+11]]+r[t[e+12]]+r[t[e+13]]+r[t[e+14]]+r[t[e+15]]).toLowerCase()}var h,W=new Uint8Array(16);function Q(){if(!h&&(h=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!h))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return h(W)}var Z=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const q={randomUUID:Z};function ee(t,e,g){if(q.randomUUID&&!e&&!t)return q.randomUUID();t=t||{};var u=t.random||(t.rng||Q)();return u[6]=u[6]&15|64,u[8]=u[8]&63|128,K(u)}const te="/gala-clicker/galaStudent.webp",oe="/gala-clicker/galaTrainee.webp",ae="/gala-clicker/galaJunior.webp",ne="/gala-clicker/galaMiddle.webp",re="/gala-clicker/galaSenior.webp",le="/gala-clicker/galaTeamLead.webp",se="/gala-clicker/galaGoogle.webp",R="https://9dac-37-161-182-123.ngrok-free.app/api/users/";async function P(t){try{const e=await fetch(`${R}${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(e){return console.error("Error updating user:",e),{error:"Error updating user data"}}}async function ce(t){try{let e=await fetch("https://9dac-37-161-182-123.ngrok-free.app/api/users/244718113");if(console.log("response1",e),!e.ok)throw new Error(`Request error! status: ${e.status}`);let g=await e.json();console.log("User fetched:",g)}catch(e){e.log("Error fetching user:",e),console.error("Error fetching user:",e)}}async function ie(t){try{const e=await fetch(R,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(e){return console.error("Error creating user:",e),{error:"Error creating user data"}}}function N(t){const e=document.querySelectorAll("nav ul li a"),g=document.querySelectorAll(".section");e.forEach(o=>{o.addEventListener("click",a=>{a.preventDefault();const l=a.target.getAttribute("data-section");g.forEach(c=>{c.id===l?c.classList.add("active"):c.classList.remove("active")})})}),document.querySelectorAll("img").forEach(o=>{o.addEventListener("contextmenu",a=>a.preventDefault()),o.setAttribute("draggable","false")});const n=document.querySelector("#circle"),s=document.querySelector("#score"),p=document.querySelector("#daily-score"),j=document.querySelector("#monthly-score"),V=document.querySelector("#progress-fill"),X=document.querySelector("#clicks-left"),Y=document.querySelector("#available-lines");let d=localStorage.getItem("availableLines")?Number(localStorage.getItem("availableLines")):100,v=null,w=null;const y=[{id:1,name:"Student",numberOfCodeLines:0,imgUrl:te,xlevel:1,maxLines:100},{id:2,name:"Trainee",numberOfCodeLines:1e4,imgUrl:oe,xlevel:1,maxLines:100},{id:3,name:"Junior",numberOfCodeLines:1e5,imgUrl:ae,xlevel:5,maxLines:200},{id:4,name:"Middle",numberOfCodeLines:1e6,imgUrl:ne,xlevel:10,maxLines:400},{id:5,name:"Senior",numberOfCodeLines:1e7,imgUrl:re,xlevel:15,maxLines:600},{id:6,name:"Team Lead",numberOfCodeLines:1e8,imgUrl:le,xlevel:25,maxLines:800},{id:7,name:"Google",numberOfCodeLines:1e9,imgUrl:se,xlevel:50,maxLines:999}];function G(o){J(),H(),C(i()),T($()),O(E()),_(),M(),D(),I(),d<m(i()).maxLines&&(v=setInterval(k,1e3)),z(t)}function C(o){localStorage.setItem("score",o),s.textContent=o}function T(o){localStorage.setItem("dailyScore",o),p.textContent=o}function O(o){localStorage.setItem("monthlyScore",o),j.textContent=o}function i(){return Number(localStorage&&localStorage.getItem("score"))||0}function $(){return Number(localStorage.getItem("dailyScore"))||0}function E(){return Number(localStorage.getItem("monthlyScore"))||0}function J(){const o=localStorage.getItem("lastUpdated"),a=new Date().toISOString().split("T")[0];o!==a&&(localStorage.setItem("dailyScore",0),localStorage.setItem("lastUpdated",a))}function H(){const o=localStorage.getItem("lastUpdatedMonthly"),a=new Date().toISOString().slice(0,7);o!==a&&(localStorage.setItem("monthlyScore",0),localStorage.setItem("lastUpdatedMonthly",a))}function F(){if(d>0){const o=i(),a=m(o),l=i()+a.xlevel,c=$()+a.xlevel,L=E()+a.xlevel;d-=1,localStorage.setItem("availableLines",d),C(l),T(c),O(L),_(),M(),D(),I();const b={id:localStorage.getItem("userId"),first_name:localStorage.getItem("first_name"),last_name:localStorage.getItem("last_name"),username:localStorage.getItem("username"),score:l,level:a.id,availableLines:d};P(b),clearTimeout(w),clearInterval(v),w=setTimeout(()=>{v=setInterval(k,1e3)},5e3)}else{n.classList.add("grayscale");return}}function _(){const o=i(),a=A(o),l=m(o),c=(o-l.numberOfCodeLines)/(a.numberOfCodeLines-l.numberOfCodeLines)*100;V.style.width=`${c}%`}function D(){const o=i(),a=A(o),l=m(o),c=Math.ceil((a.numberOfCodeLines-o)/l.xlevel);X.textContent=`Lines left level ${a.name}: ${c}`}function M(){const o=i(),a=m(o);n.setAttribute("src",`${a.imgUrl}`)}function I(){const o=i(),a=m(o);Y.textContent=`${d} / ${a.maxLines}`}function k(){const o=i(),a=m(o);d<a.maxLines?(d+=1,localStorage.setItem("availableLines",d),I(),P(t),d>0&&n.classList.remove("grayscale")):clearInterval(v)}function m(o){return y.slice().reverse().find(a=>o>=a.numberOfCodeLines)||y[0]}function A(o){return y.find(a=>o<a.numberOfCodeLines)||y[y.length-1]}function z(o){const a=document.querySelector(".user__info"),l=i(),c=m(l);a.innerHTML=`
            <p>Total Clicks: ${l}</p>
            <p>Current Level: ${c.name}</p>
            <p>First Name: ${o.first_name}</p>
            <p>Last Name: ${o.last_name}</p>
        `}n.addEventListener("click",o=>{const a=n.getBoundingClientRect(),l=o.clientX-a.left-a.width/2,c=o.clientY-a.top-a.height/2,L=40,b=c/a.height*L,B=l/a.width*-L;n.style.setProperty("--tiltX",`${b}deg`),n.style.setProperty("--tiltY",`${B}deg`),setTimeout(()=>{n.style.setProperty("--tiltX","0deg"),n.style.setProperty("--tiltY","0deg")},200);const S=document.createElement("div");S.classList.add("plusone"),S.textContent=`+${m(i()).xlevel}`,S.style.left=`${o.clientX-a.left}px`,S.style.top=`${o.clientY-a.top}px`,n.parentElement.appendChild(S),F(),setTimeout(()=>{S.remove()},2e3)}),G()}const x=window.Telegram.WebApp,f=x.initDataUnsafe.user;console.log("TG.initDataUnsafe.user",f);if(f){const t={id:f.id,username:f.username,first_name:f.first_name,last_name:f.last_name,score:0,dailyScore:0,monthlyScore:0,lastUpdated:new Date,lastUpdatedMonthly:new Date,availableLines:100};ce(f.id).then(e=>{console.log("response",e),e.status?(console.log("new user",t),ie(t),localStorage.setItem("score",t.score),localStorage.setItem("dailyScore",t.dailyScore),localStorage.setItem("monthlyScore",t.monthlyScore),localStorage.setItem("level",t.level),localStorage.setItem("first_name",t.first_name),localStorage.setItem("last_name",t.last_name),localStorage.setItem("availableLines",t.availableLines),localStorage.setItem("username",t.username),localStorage.setItem("userId",t.id),localStorage.setItem("lastUpdated",t.lastUpdated),localStorage.setItem("lastUpdatedMonthly",t.lastUpdatedMonthly)):(localStorage.setItem("score",e.score),localStorage.setItem("dailyScore",e.dailyScore),localStorage.setItem("monthlyScore",e.monthlyScore),localStorage.setItem("level",e.level),localStorage.setItem("first_name",e.first_name),localStorage.setItem("last_name",e.last_name),localStorage.setItem("availableLines",e.availableLines),localStorage.setItem("username",e.username)),console.log("initializeApp"),N(t)}),x.expand(),x.ready()}else N({id:ee(),first_name:"Test",last_name:"Testovich",username:"Testolio",score:0,dailyScore:0,monthlyScore:0,lastUpdated:new Date,lastUpdatedMonthly:new Date().toISOString().slice(0,7),availableLines:0});
