(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))d(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const y of s.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&d(y)}).observe(document,{childList:!0,subtree:!0});function g(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function d(n){if(n.ep)return;n.ep=!0;const s=g(n);fetch(n.href,s)}})();var a=[];for(var U=0;U<256;++U)a.push((U+256).toString(16).slice(1));function K(o,e=0){return(a[o[e+0]]+a[o[e+1]]+a[o[e+2]]+a[o[e+3]]+"-"+a[o[e+4]]+a[o[e+5]]+"-"+a[o[e+6]]+a[o[e+7]]+"-"+a[o[e+8]]+a[o[e+9]]+"-"+a[o[e+10]]+a[o[e+11]]+a[o[e+12]]+a[o[e+13]]+a[o[e+14]]+a[o[e+15]]).toLowerCase()}var I,W=new Uint8Array(16);function Q(){if(!I&&(I=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!I))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return I(W)}var Z=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const R={randomUUID:Z};function ee(o,e,g){if(R.randomUUID&&!e&&!o)return R.randomUUID();o=o||{};var d=o.random||(o.rng||Q)();return d[6]=d[6]&15|64,d[8]=d[8]&63|128,K(d)}const te="/gala-clicker/galaStudent.webp",oe="/gala-clicker/galaTrainee.webp",le="/gala-clicker/galaJunior.webp",ne="/gala-clicker/galaMiddle.webp",ae="/gala-clicker/galaSenior.webp",re="/gala-clicker/galaTeamLead.webp",se="/gala-clicker/galaGoogle.webp",V="http://localhost:8080/api/users/";async function N(o){try{const e=await fetch(`${V}${o.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(e){return console.error("Error updating user:",e),{error:"Error updating user data"}}}async function ce(o){try{let e=await fetch(`${V}${o}`);if(console.log("response1",e),!e.ok)throw new Error(`Request error! status: ${e.status}`);let g=await e.json();return console.log("User fetched:",g),g}catch(e){console.error("Error fetching user:",e)}}function x(o){const e=document.querySelectorAll("nav ul li a"),g=document.querySelectorAll(".section");e.forEach(t=>{t.addEventListener("click",l=>{l.preventDefault();const r=l.target.getAttribute("data-section");g.forEach(c=>{c.id===r?c.classList.add("active"):c.classList.remove("active")})})}),document.querySelectorAll("img").forEach(t=>{t.addEventListener("contextmenu",l=>l.preventDefault()),t.setAttribute("draggable","false")});const n=document.querySelector("#circle"),s=document.querySelector("#score"),y=document.querySelector("#daily-score"),X=document.querySelector("#monthly-score"),Y=document.querySelector("#progress-fill"),G=document.querySelector("#clicks-left"),j=document.querySelector("#available-lines");let m=localStorage.getItem("availableLines"),v=null,$=null;const f=[{id:1,name:"Student",numberOfCodeLines:0,imgUrl:te,xlevel:1,maxLines:100},{id:2,name:"Trainee",numberOfCodeLines:1e4,imgUrl:oe,xlevel:1,maxLines:100},{id:3,name:"Junior",numberOfCodeLines:1e5,imgUrl:le,xlevel:5,maxLines:200},{id:4,name:"Middle",numberOfCodeLines:1e6,imgUrl:ne,xlevel:10,maxLines:400},{id:5,name:"Senior",numberOfCodeLines:1e7,imgUrl:ae,xlevel:15,maxLines:600},{id:6,name:"Team Lead",numberOfCodeLines:1e8,imgUrl:re,xlevel:25,maxLines:800},{id:7,name:"Google",numberOfCodeLines:1e9,imgUrl:se,xlevel:50,maxLines:999}];function J(t){F(),H(),C(i()),O(_()),T(D()),M(),k(),E(),b(),m<u(i()).maxLines&&(v=setInterval(A,1e3)),P(o)}function C(t){localStorage.setItem("score",t),s.textContent=t}function O(t){localStorage.setItem("dailyScore",t),y.textContent=t}function T(t){localStorage.setItem("monthlyScore",t),X.textContent=t}function i(){return Number(localStorage&&localStorage.getItem("score"))||0}function _(){return Number(localStorage.getItem("dailyScore"))||0}function D(){return Number(localStorage.getItem("monthlyScore"))||0}function F(){const t=localStorage.getItem("lastUpdated"),l=new Date().toISOString().split("T")[0];t!==l&&(localStorage.setItem("dailyScore",0),localStorage.setItem("lastUpdated",l))}function H(){const t=localStorage.getItem("lastUpdatedMonthly"),l=new Date().toISOString().slice(0,7);t!==l&&(localStorage.setItem("monthlyScore",0),localStorage.setItem("lastUpdatedMonthly",l))}function B(){if(m>0){const t=i(),l=u(t),r=i()+l.xlevel,c=_()+l.xlevel,L=D()+l.xlevel;m-=1,localStorage.setItem("availableLines",m),C(r),O(c),T(L),M(),k(),E(),b();const h={id:localStorage.getItem("userId"),first_name:localStorage.getItem("first_name"),last_name:localStorage.getItem("last_name"),username:localStorage.getItem("username"),score:r,dailyScore:localStorage.getItem("dailyScore"),monthlyScore:localStorage.getItem("monthlyScore"),lastUpdated:localStorage.getItem("lastUpdated"),lastUpdatedMonthly:localStorage.getItem("lastUpdatedMonthly"),availableLines:localStorage.getItem("availableLines")};console.log("Updated user:",h),setInterval(()=>{P(),N(h)},6e4),clearTimeout($),clearInterval(v),$=setTimeout(()=>{v=setInterval(A,1e3)},5e3)}else{n.classList.add("grayscale");return}}function M(){const t=i(),l=q(t),r=u(t),c=(t-r.numberOfCodeLines)/(l.numberOfCodeLines-r.numberOfCodeLines)*100;Y.style.width=`${c}%`}function E(){const t=i(),l=q(t),r=u(t),c=Math.ceil((l.numberOfCodeLines-t)/r.xlevel);G.textContent=`Lines left level ${l.name}: ${c}`}function k(){const t=i(),l=u(t);n.setAttribute("src",`${l.imgUrl}`)}function b(){const t=i(),l=u(t);j.textContent=`${m} / ${l.maxLines}`}function A(){const t=i(),l=u(t);m<l.maxLines?(m+=1,localStorage.setItem("availableLines",m),b(),N(o),m>0&&n.classList.remove("grayscale")):clearInterval(v)}function u(t){return f.slice().reverse().find(l=>t>=l.numberOfCodeLines)||f[0]}function q(t){return f.find(l=>t<l.numberOfCodeLines)||f[f.length-1]}function P(t){const l=document.querySelector(".user__info"),r=i(),c=u(r);l.innerHTML=`
            <p>Total Clicks: ${r}</p>
            <p>Current Level: ${c.name}</p>
            <p>First Name: ${t.first_name}</p>
            <p>Last Name: ${t.last_name}</p>
        `}n.addEventListener("click",t=>{const l=n.getBoundingClientRect(),r=t.clientX-l.left-l.width/2,c=t.clientY-l.top-l.height/2,L=40,h=c/l.height*L,z=r/l.width*-L;n.style.setProperty("--tiltX",`${h}deg`),n.style.setProperty("--tiltY",`${z}deg`),setTimeout(()=>{n.style.setProperty("--tiltX","0deg"),n.style.setProperty("--tiltY","0deg")},200);const p=document.createElement("div");p.classList.add("plusone"),p.textContent=`+${u(i()).xlevel}`,p.style.left=`${t.clientX-l.left}px`,p.style.top=`${t.clientY-l.top}px`,n.parentElement.appendChild(p),B(),setTimeout(()=>{p.remove()},2e3)}),J()}const w=window.Telegram.WebApp,S=w.initDataUnsafe.user;console.log("TG.initDataUnsafe.user",S);S?(ce(S.id).then(o=>{if(o)localStorage.setItem("userId",o.id),localStorage.setItem("username",o.username),localStorage.setItem("first_name",o.first_name),localStorage.setItem("last_name",o.last_name),localStorage.setItem("score",o.score),localStorage.setItem("dailyScore",o.dailyScore),localStorage.setItem("monthlyScore",o.monthlyScore),localStorage.setItem("lastUpdated",o.lastUpdated),localStorage.setItem("lastUpdatedMonthly",o.lastUpdatedMonthly),localStorage.setItem("availableLines",o.availableLines),x(o);else{const e={id:S.id,username:S.username,first_name:S.first_name,last_name:S.last_name,score:0,dailyScore:0,monthlyScore:0,lastUpdated:new Date,lastUpdatedMonthly:new Date,availableLines:100};localStorage.setItem("score",e.score),localStorage.setItem("dailyScore",e.dailyScore),localStorage.setItem("monthlyScore",e.monthlyScore),localStorage.setItem("level",e.level),localStorage.setItem("first_name",e.first_name),localStorage.setItem("last_name",e.last_name),localStorage.setItem("availableLines",e.availableLines),localStorage.setItem("username",e.username),localStorage.setItem("userId",e.id),localStorage.setItem("lastUpdated",e.lastUpdated),localStorage.setItem("lastUpdatedMonthly",e.lastUpdatedMonthly),x(e)}}),w.expand(),w.ready()):x({id:ee(),first_name:"Test",last_name:"Testovich",username:"Testolio",score:0,dailyScore:0,monthlyScore:0,lastUpdated:new Date,lastUpdatedMonthly:new Date().toISOString().slice(0,7),availableLines:0});
