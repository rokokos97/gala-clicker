(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))L(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const f of r.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&L(f)}).observe(document,{childList:!0,subtree:!0});function g(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerPolicy&&(r.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?r.credentials="include":l.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function L(l){if(l.ep)return;l.ep=!0;const r=g(l);fetch(l.href,r)}})();const H="/gala-clicker/galaStudent.webp",B="/gala-clicker/galaTrainee.webp",V="/gala-clicker/galaJunior.webp",z="/gala-clicker/galaMiddle.webp",K="/gala-clicker/galaSenior.webp",W="/gala-clicker/galaTeamLead.webp",Q="/gala-clicker/galaGoogle.webp",A="https://9dac-37-161-182-123.ngrok-free.app/api/users/";async function I(a){try{const o=await fetch(`${A}${a.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){return console.error("Error updating user:",o),{error:"Error updating user data"}}}async function Z(a){try{const o=await fetch(`${A}${a}`);if(!o.ok){if(o.status===404)return null;throw new Error(`HTTP error! status: ${o.status}`)}return await o.json()}catch(o){return console.error("Error fetching user:",o),{error:"Error fetching user data"}}}function D(a){const o=document.querySelectorAll("nav ul li a"),g=document.querySelectorAll(".section");o.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const n=t.target.getAttribute("data-section");g.forEach(s=>{s.id===n?s.classList.add("active"):s.classList.remove("active")})})}),document.querySelectorAll("img").forEach(e=>{e.addEventListener("contextmenu",t=>t.preventDefault()),e.setAttribute("draggable","false")});const l=document.querySelector("#circle"),r=document.querySelector("#score"),f=document.querySelector("#daily-score"),q=document.querySelector("#monthly-score"),P=document.querySelector("#progress-fill"),N=document.querySelector("#clicks-left"),R=document.querySelector("#available-lines");let i=localStorage.getItem("availableLines")?Number(localStorage.getItem("availableLines")):100,y=null,x=null;const S=[{id:1,name:"Student",numberOfCodeLines:0,imgUrl:H,xlevel:1,maxLines:100},{id:2,name:"Trainee",numberOfCodeLines:1e4,imgUrl:B,xlevel:1,maxLines:100},{id:3,name:"Junior",numberOfCodeLines:1e5,imgUrl:V,xlevel:5,maxLines:200},{id:4,name:"Middle",numberOfCodeLines:1e6,imgUrl:z,xlevel:10,maxLines:400},{id:5,name:"Senior",numberOfCodeLines:1e7,imgUrl:K,xlevel:15,maxLines:600},{id:6,name:"Team Lead",numberOfCodeLines:1e8,imgUrl:W,xlevel:25,maxLines:800},{id:7,name:"Google",numberOfCodeLines:1e9,imgUrl:Q,xlevel:50,maxLines:999}];function X(e){Y(),G(),w(c()),U(C()),$(O()),T(),E(),_(),v(),i<d(c()).maxLines&&(y=setInterval(M,1e3)),j(a)}function w(e){localStorage.setItem("score",e),r.textContent=e}function U(e){localStorage.setItem("dailyScore",e),f.textContent=e}function $(e){localStorage.setItem("monthlyScore",e),q.textContent=e}function c(){return Number(localStorage&&localStorage.getItem("score"))||0}function C(){return Number(localStorage.getItem("dailyScore"))||0}function O(){return Number(localStorage.getItem("monthlyScore"))||0}function Y(){const e=localStorage.getItem("lastUpdated"),t=new Date().toISOString().split("T")[0];e!==t&&(localStorage.setItem("dailyScore",0),localStorage.setItem("lastUpdated",t))}function G(){const e=localStorage.getItem("lastUpdatedMonthly"),t=new Date().toISOString().slice(0,7);e!==t&&(localStorage.setItem("monthlyScore",0),localStorage.setItem("lastUpdatedMonthly",t))}function J(){if(i>0){const e=c(),t=d(e),n=c()+t.xlevel,s=C()+t.xlevel,p=O()+t.xlevel;i-=1,localStorage.setItem("availableLines",i),w(n),U(s),$(p),T(),E(),_(),v();const h={id:localStorage.getItem("userId"),first_name:localStorage.getItem("first_name"),last_name:localStorage.getItem("last_name"),username:localStorage.getItem("username"),score:n,level:t.id,availableLines:i};I(h),clearTimeout(x),clearInterval(y),x=setTimeout(()=>{y=setInterval(M,1e3)},5e3)}else{l.classList.add("grayscale");return}}function T(){const e=c(),t=k(e),n=d(e),s=(e-n.numberOfCodeLines)/(t.numberOfCodeLines-n.numberOfCodeLines)*100;P.style.width=`${s}%`}function _(){const e=c(),t=k(e),n=d(e),s=Math.ceil((t.numberOfCodeLines-e)/n.xlevel);N.textContent=`Lines left level ${t.name}: ${s}`}function E(){const e=c(),t=d(e);l.setAttribute("src",`${t.imgUrl}`)}function v(){const e=c(),t=d(e);R.textContent=`${i} / ${t.maxLines}`}function M(){const e=c(),t=d(e);i<t.maxLines?(i+=1,localStorage.setItem("availableLines",i),v(),I(a),i>0&&l.classList.remove("grayscale")):clearInterval(y)}function d(e){return S.slice().reverse().find(t=>e>=t.numberOfCodeLines)||S[0]}function k(e){return S.find(t=>e<t.numberOfCodeLines)||S[S.length-1]}function j(e){const t=document.querySelector(".user__info"),n=c(),s=d(n);t.innerHTML=`
            <p>Total Clicks: ${n}</p>
            <p>Current Level: ${s.name}</p>
            <p>First Name: ${e.first_name}</p>
            <p>Last Name: ${e.last_name}</p>
        `}l.addEventListener("click",e=>{const t=l.getBoundingClientRect(),n=e.clientX-t.left-t.width/2,s=e.clientY-t.top-t.height/2,p=40,h=s/t.height*p,F=n/t.width*-p;l.style.setProperty("--tiltX",`${h}deg`),l.style.setProperty("--tiltY",`${F}deg`),setTimeout(()=>{l.style.setProperty("--tiltX","0deg"),l.style.setProperty("--tiltY","0deg")},200);const u=document.createElement("div");u.classList.add("plusone"),u.textContent=`+${d(c()).xlevel}`,u.style.left=`${e.clientX-t.left}px`,u.style.top=`${e.clientY-t.top}px`,l.parentElement.appendChild(u),J(),setTimeout(()=>{u.remove()},2e3)}),X()}const b=window.Telegram.WebApp,m=b.initDataUnsafe.user;console.log("TG.initDataUnsafe.user",m);if(m){const a={id:m.id,first_name:m.first_name,last_name:m.last_name,username:m.username,score:0,dailyScore:0,monthlyScore:0,lastUpdated:new Date,lastUpdatedMonthly:new Date().toISOString().slice(0,7),availableLines:100};Z(m.id).then(o=>{console.log("response",o),o.status?(I(a),localStorage.setItem("score",a.score),localStorage.setItem("dailyScore",a.dailyScore),localStorage.setItem("monthlyScore",a.monthlyScore),localStorage.setItem("level",a.level),localStorage.setItem("first_name",a.first_name),localStorage.setItem("last_name",a.last_name),localStorage.setItem("availableLines",a.availableLines),localStorage.setItem("username",a.username),localStorage.setItem("userId",a.id),localStorage.setItem("lastUpdated",a.lastUpdated),localStorage.setItem("lastUpdatedMonthly",a.lastUpdatedMonthly)):(localStorage.setItem("score",o.score),localStorage.setItem("dailyScore",o.dailyScore),localStorage.setItem("monthlyScore",o.monthlyScore),localStorage.setItem("level",o.level),localStorage.setItem("first_name",o.first_name),localStorage.setItem("last_name",o.last_name),localStorage.setItem("availableLines",o.availableLines),localStorage.setItem("username",o.username)),D(a)}),b.expand(),b.ready()}else D();
